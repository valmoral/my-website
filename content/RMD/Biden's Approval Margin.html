---
title: "Biden's Approval Margin"
author: "Valeria Morales, Lazar Jelic, Hanlu Lin, Hao Ni, Purva Sikri, Junna Yanai"
date: "9/17/2021"
output: html_document
---

<script src="Biden's Approval Margin_files/header-attrs/header-attrs.js"></script>


<div id="bidens-approval-margins" class="section level1">
<h1>Biden’s Approval Margins</h1>
<pre class="r"><code># Import approval polls data directly off fivethirtyeight website
approval_polllist &lt;- read_csv(&#39;https://projects.fivethirtyeight.com/biden-approval-data/approval_polllist.csv&#39;) </code></pre>
<pre><code>## Rows: 1600 Columns: 22</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (12): president, subgroup, modeldate, startdate, enddate, pollster, grad...
## dbl  (9): samplesize, weight, influence, approve, disapprove, adjusted_appro...
## lgl  (1): tracking</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>glimpse(approval_polllist)</code></pre>
<pre><code>## Rows: 1,600
## Columns: 22
## $ president           &lt;chr&gt; &quot;Joseph R. Biden Jr.&quot;, &quot;Joseph R. Biden Jr.&quot;, &quot;Jos…
## $ subgroup            &lt;chr&gt; &quot;All polls&quot;, &quot;All polls&quot;, &quot;All polls&quot;, &quot;All polls&quot;…
## $ modeldate           &lt;chr&gt; &quot;9/17/2021&quot;, &quot;9/17/2021&quot;, &quot;9/17/2021&quot;, &quot;9/17/2021&quot;…
## $ startdate           &lt;chr&gt; &quot;1/31/2021&quot;, &quot;2/1/2021&quot;, &quot;2/1/2021&quot;, &quot;2/2/2021&quot;, &quot;…
## $ enddate             &lt;chr&gt; &quot;2/2/2021&quot;, &quot;2/3/2021&quot;, &quot;2/3/2021&quot;, &quot;2/4/2021&quot;, &quot;2…
## $ pollster            &lt;chr&gt; &quot;YouGov&quot;, &quot;Rasmussen Reports/Pulse Opinion Researc…
## $ grade               &lt;chr&gt; &quot;B+&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B-&quot;, &quot;A-&quot;, &quot;B&quot;, &quot;B-&quot;, &quot;…
## $ samplesize          &lt;dbl&gt; 1500, 1500, 15000, 1500, 15000, 1005, 1429, 15000,…
## $ population          &lt;chr&gt; &quot;a&quot;, &quot;lv&quot;, &quot;a&quot;, &quot;lv&quot;, &quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;rv&quot;, &quot;l…
## $ weight              &lt;dbl&gt; 1.08560770, 0.33082275, 0.27856273, 0.30863314, 0.…
## $ influence           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ approve             &lt;dbl&gt; 46, 52, 54, 49, 54, 57, 49, 54, 60, 50, 54, 55, 51…
## $ disapprove          &lt;dbl&gt; 38, 46, 33, 48, 34, 34, 39, 34, 32, 47, 34, 33, 46…
## $ adjusted_approve    &lt;dbl&gt; 47.23841, 54.36302, 52.51549, 51.36302, 52.51549, …
## $ adjusted_disapprove &lt;dbl&gt; 38.33273, 40.06799, 36.33995, 42.06799, 37.33995, …
## $ multiversions       &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ tracking            &lt;lgl&gt; NA, TRUE, TRUE, TRUE, TRUE, NA, NA, TRUE, NA, TRUE…
## $ url                 &lt;chr&gt; &quot;https://docs.cdn.yougov.com/460mactkmh/econTabRep…
## $ poll_id             &lt;dbl&gt; 74332, 74338, 74366, 74347, 74367, 74345, 74348, 7…
## $ question_id         &lt;dbl&gt; 139593, 139642, 139733, 139654, 139734, 139652, 13…
## $ createddate         &lt;chr&gt; &quot;2/3/2021&quot;, &quot;2/4/2021&quot;, &quot;2/11/2021&quot;, &quot;2/5/2021&quot;, &quot;…
## $ timestamp           &lt;chr&gt; &quot;09:37:08 17 Sep 2021&quot;, &quot;09:37:08 17 Sep 2021&quot;, &quot;0…</code></pre>
<pre class="r"><code># Use `lubridate` to fix dates, as they are given as characters.
approval_polllist &lt;- approval_polllist %&gt;%
  mutate(
    modeldate=mdy(modeldate), 
    startdate=mdy(startdate),
    enddate=mdy(enddate),
    createddate=mdy(createddate)
  )

glimpse(approval_polllist)</code></pre>
<pre><code>## Rows: 1,600
## Columns: 22
## $ president           &lt;chr&gt; &quot;Joseph R. Biden Jr.&quot;, &quot;Joseph R. Biden Jr.&quot;, &quot;Jos…
## $ subgroup            &lt;chr&gt; &quot;All polls&quot;, &quot;All polls&quot;, &quot;All polls&quot;, &quot;All polls&quot;…
## $ modeldate           &lt;date&gt; 2021-09-17, 2021-09-17, 2021-09-17, 2021-09-17, 2…
## $ startdate           &lt;date&gt; 2021-01-31, 2021-02-01, 2021-02-01, 2021-02-02, 2…
## $ enddate             &lt;date&gt; 2021-02-02, 2021-02-03, 2021-02-03, 2021-02-04, 2…
## $ pollster            &lt;chr&gt; &quot;YouGov&quot;, &quot;Rasmussen Reports/Pulse Opinion Researc…
## $ grade               &lt;chr&gt; &quot;B+&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B-&quot;, &quot;A-&quot;, &quot;B&quot;, &quot;B-&quot;, &quot;…
## $ samplesize          &lt;dbl&gt; 1500, 1500, 15000, 1500, 15000, 1005, 1429, 15000,…
## $ population          &lt;chr&gt; &quot;a&quot;, &quot;lv&quot;, &quot;a&quot;, &quot;lv&quot;, &quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;rv&quot;, &quot;l…
## $ weight              &lt;dbl&gt; 1.08560770, 0.33082275, 0.27856273, 0.30863314, 0.…
## $ influence           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ approve             &lt;dbl&gt; 46, 52, 54, 49, 54, 57, 49, 54, 60, 50, 54, 55, 51…
## $ disapprove          &lt;dbl&gt; 38, 46, 33, 48, 34, 34, 39, 34, 32, 47, 34, 33, 46…
## $ adjusted_approve    &lt;dbl&gt; 47.23841, 54.36302, 52.51549, 51.36302, 52.51549, …
## $ adjusted_disapprove &lt;dbl&gt; 38.33273, 40.06799, 36.33995, 42.06799, 37.33995, …
## $ multiversions       &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ tracking            &lt;lgl&gt; NA, TRUE, TRUE, TRUE, TRUE, NA, NA, TRUE, NA, TRUE…
## $ url                 &lt;chr&gt; &quot;https://docs.cdn.yougov.com/460mactkmh/econTabRep…
## $ poll_id             &lt;dbl&gt; 74332, 74338, 74366, 74347, 74367, 74345, 74348, 7…
## $ question_id         &lt;dbl&gt; 139593, 139642, 139733, 139654, 139734, 139652, 13…
## $ createddate         &lt;date&gt; 2021-02-03, 2021-02-04, 2021-02-11, 2021-02-05, 2…
## $ timestamp           &lt;chr&gt; &quot;09:37:08 17 Sep 2021&quot;, &quot;09:37:08 17 Sep 2021&quot;, &quot;0…</code></pre>
<div id="create-a-plot" class="section level2">
<h2>Create a plot</h2>
<pre class="r"><code>knitr::include_graphics(&quot;../images/biden_approval_margin.png&quot;, error = FALSE)</code></pre>
<p><img src="../images/biden_approval_margin.png" width="100%" /></p>
</div>
<div id="replicating-the-biden-approval-margin-graph" class="section level2">
<h2>Replicating the Biden Approval Margin graph</h2>
<pre class="r"><code>plot &lt;- approval_polllist %&gt;%
  mutate(week=week(enddate)) %&gt;% #Creating a new column called week by extracting the week from the enddate variable
  group_by(week) %&gt;%
  mutate(
    net_approval_rate=approve-disapprove #Creating a new column called net_approval_rate by subtracting disapprove from approve
  ) %&gt;%
  summarise(
    mean=mean(net_approval_rate), #Mean net approval by week
    sd=sd(net_approval_rate), #Standard deviation of net approval by week
    count=n(), #Count by week
    se=sd/sqrt(count), #Standard error of the week 
    t_critical=qt(0.975, count-1), #T-critical value
    lower=mean-t_critical*se, #Lower end of the CI
    upper=mean+t_critical*se #Upper end of the CI
  ) %&gt;%
  
  #Scatterplot of the calculated net approval rate means by week 
  ggplot(aes(x=week, y=mean)) + 
  geom_point(colour=&#39;red&#39;) + #Scatterplot using red points
  geom_line(colour=&#39;red&#39;, size=0.25) + #Adding a red line to connect the points
  geom_ribbon(aes(ymin=lower, ymax=upper), colour=&#39;red&#39;, linetype=1, alpha=0.1, size=0.25) +
  geom_smooth(se=F) + #Adding a smooth line for the trend
  geom_hline(yintercept=0, color=&#39;orange&#39;, size=2) + #Adding an orange horizontal line
  theme_bw() + #Theme
  labs(title=&#39;Estimating Approval Margin (approve-disapprove) for Joe Biden&#39;, #Adding a title
       subtitle=&#39;Weekly average of all polls&#39;, #Subtitle
       x=&#39;Week of the year&#39;, #X-label
       y=&#39;Average Approval Margin (Approve - Disapprove)&#39;) + #Y-label
  NULL

ggsave(file=&#39;bidenplot_home.jpg&#39;, plot=plot, path = &#39;~/Desktop/LBS/Term1/my-website/my-website/static/img&#39;, height=18, width = 18)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<pre class="r"><code>ggsave(file=&#39;bidenplot.jpg&#39;, plot=plot, path = &#39;~/Desktop/LBS/Term1/my-website/my-website/static/img&#39;, height=8, width = 18)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
</div>
<div id="compare-confidence-intervals" class="section level2">
<h2>Compare Confidence Intervals</h2>
<blockquote>
<p>Answer below</p>
</blockquote>
<p>The confidence interval for ‘week 4’ ranges from 9.14 to 19.6828 with a mean of 14.41 and standard deviation of 10.25, while ‘week 25’ ranges from 10.30 to 12.7523 with a mean of 11.53 and a standard deviation of 4.74. This is mainly due to the number of data points. For ‘week 4’ we only have 17 data points to work with, while ‘week 25’ has 60. With a larger set of data to work with, we are able to create narrower intervals with the same level of confidence.</p>
</div>
</div>
